name: Pesquisa de pre√ßo de passagens 

on: 
   workflow_dispatch:
   schedule:
      - cron: '0 8,16,22,3 * * *'

jobs:
  run_automation:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Install Dependecies
      env:
        PYTHON_VERSION: "3.10"
      run: |
        py_version=$PYTHON_VERSION
        sudo apt update
        sudo apt install software-properties-common
        sudo add-apt-repository -y ppa:deadsnakes/ppa
        sudo apt update
        sudo apt install python"$py_version"
        sudo apt install -y nodejs
    - name: Verify Version
      run: |
          python --version
          nodejs -v
          npm --version
          aws --version
    - name: Install libraries for robot
      run: |
          pip install -U pip
          pip install selenium==4.9.1
          pip install -r requirements.txt
    - name: Run Tests
      run: |
            mkdir results
            robot -d ./reports ./test-cases   
    
    - name: Upload test results
      uses: actions/upload-artifact@v1
      if: always()
      with:
        name: reports
        path: valores.md  
    
    - uses: dtinth/markdown-report-action@v1.0.0
      name: create report from markdown
      with:
               title: reports
               body-file: valores.md
               
#     - name: markdown-reporter
#       uses: PavanMudigonda/markdown-reporter@v0.1
#       with:
#         markdown_path: valores.md 
#         report_name: valores.md  
#         report_title: report 
#         github_token: ${{ secrets.GITHUB_TOKEN }}
#         skip_check_run: true


    - name: Send email
  # You may pin to the exact commit or the version.
  # uses: dawidd6/action-send-mail@fa73d6accd067d4151b71f124ed939da15097abf
      uses: dawidd6/action-send-mail@v3.7.2
      with:
    # Subject of mail message
        subject: vanderlan 
    # Recipients mail addresses (separated with comma)
        to: vanderlan.alves.filho@gmail.com 
    # Full name of mail sender (might be with an email address specified in <>)
        from: vanderlan.alves.filho@gmail.com 
    # Body of mail message (might be a filename prefixed with file:// to read from)
